<html>
<head>
    <link rel="stylesheet" type="text/css" href="style/cc.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="script/kinetic-v3.8.0.js"></script>
    <script src="script/meme.js"></script>
    <script src="script/enemy.js"></script>
    <script src="script/background.js"></script>    
</head>
<body>
    <div id="main"></div>
  
    <script>
    var stage = new Kinetic.Stage("main", 1024, 640);
    var layer = new Kinetic.Layer();
    var enemy_layer = new Kinetic.Layer();
    var meme_layer = new Kinetic.Layer();
    var bullet_layer = new Kinetic.Layer();
    var running = false;
    var debug = true;
    var recalculate = false;
    
    console.log("creating metrix");
    var matrix = new Array(12);
    for (var i = 0; i < 12; i++) {
        matrix[i] = new Array(10);
        for (var j = 0; j < 10; j++) {
            matrix[i][j] = "empty";
        }
    }
    matrix[0][0] = "reserved";
    matrix[11][9] = "reserved";
    
    window.onload = init;
    function init(){
        var sources = {
            background: "img/background.png",
        };
        var memes = {
            lol: "img/lol.png",
            lol_glow: "img/lol_glow.png",
            lol_na: "img/lol_na.png",
            wdir: "img/what_did_i_read.png",
            wdir_glow: "img/what_did_i_read_glow.png",
            wdir_na: "img/what_did_i_read_na.png",
        };
        var enemies = {
            derpina: "img/derpina.png",
        }
        //var canvas= layer.getCanvas();
        //var context = layer.getContext();
        var current_enemy = null;
        var coordinate = null;
        var direction = null;
        var dieId = null;
        

        loadBackground(sources);
        loadMeme(memes);
        loadEnemy(enemies);
        
        var lol = new Kinetic.Shape(function(){
            var context = this.getContext();
            context.font = "12pt Calibri";
            context.fillStyle = "red";
            context.fillText("lol", 64, 64);
        });
        var lol2 = new Kinetic.Shape(function(){
            var context = this.getContext();
            context.font = "12pt Calibri";
            context.fillStyle = "red";
            context.fillText("lol", 128, 128);
        });
        bullet_layer.add(lol);
        bullet_layer.add(lol2);
        stage.add(layer);
        stage.add(bullet_layer);
        stage.add(meme_layer);
        stage.add(enemy_layer);
        
        var amplitude = 150;
        var period = 5000; // in ms
        var centerX = stage.width / 2;
            
        stage.onFrame(function(frame){
            lol.x = lol.x + 0.1;//amplitude * Math.sin(frame.time * 2 * Math.PI / period) + centerX;
            lol.y = lol.y;
            lol2.y = amplitude * Math.sin(frame.time * 2 * Math.PI / period) + centerX;
            bullet_layer.draw();
            //console.log(frame.time);
        });
    }

    </script>

</body>
</html>
